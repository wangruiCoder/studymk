# Spring cloud 学习笔记

作者：kyrie 学习笔记如有转发请标注出处

## 第一章 微服务
### 1.1 微服务的特性
- 独立运行在自己的进程中
- 一个服务只关注自己的独立业务
- 轻量的通讯机制Restful api
- 可以使用不同的语言开发
- 一系列独立服务共同构建起整个系统
- 全自动部署机制

### 1.2 微服务优点
- 独立部署，不依赖其他服务，耦合低
- 易于开发和维护，业务清晰，代码量少。模块易于开发和维护
- 启动快
- 局部修改容易
- 按需伸缩
- 职责专一
- 代码复用
- 便于团队协作

### 1.3 微服务缺点
- 分布式固有的复杂性：容错，网络延时，调用关系，分布式事务
- 分布式事务的挑战，每个服务都有自己的数据库，多个服务间调用时事务处理麻烦
    1. 刚性事务
    2. 柔性事务，最终一致性
- 接口调用成本高，网路IO，接口更改调用方可能会跟随更改
- 测试难度提升，一个接口的变更所有的调用方都要测试。
- 运维要求高。

### 1.4 设计原则
- 单一职责 ： 关注整个系统功能中单独，有界限的一部分
- 服务自治：可以独立开发，测试，部署，构建，运行
- 轻量级通讯原则：跨平台，跨语言，RestApi AMQP
- 粒度把控：与自己的实际结合，随业务进行调整。

## 第二章 spring cloud context
spring cloud 在启动的时候会创建一个bootstrap的引导上下文(bootstrap非bootstrap.yml，而是spring cloud的引导上下文)，他启动后会开始从外部环境进行配置文件的加载，例如配置中心，通过bootstrap加载进来的配置优先级最高，不会被本地的配置覆盖，加载的顺序大概如下：
![](1.png)


## 第三章 注册中心

### 3.1 为什么有注册中心
传统应用中，组件之间的调用有规范的接口，可以实现多个模块之间的互相协作，当使用微服务后，服务实例的网络地址和数量可能动态变化，原来的的传统模式再也无法满足服务变化带来的问题，这时候就需要一个中心化的组件来进行服务的登记和管理。
### 3.2 主要目的
实现服务治理，管理服务所有的服务信息和状态
### 3.3 好处
不用关心有多少提供方，只管调用接口即可。
### 3.4 常见的注册中心有
- eureka
- consul
- nacos
- zookeeper
### 3.5 服务注册包括两部分
- 服务器端
- 客户端

### 3.6 Eureka的介绍
- 是Netflix的一个组件
- 是一个基于RestApi的服务
- 是一个用于服务发现和注册的组件
- 包括server端和client端
- 屏蔽了server和server的交互细节

#### 3.6.1 服务和Eureka的关系
![](2.png)

